{"version":3,"file":"1d-b496a98d.js","sources":["../../../../components/DigitDisplaydigit.vue","../../../../pages/1d.vue"],"sourcesContent":["<template>\r\n  <div class=\"flex gap-3 justify-center\">\r\n    <div class=\"font-mono text-9xl bg-slate-200 shadow-inner rounded p-2 text-center opacity-60\">{{ display[0] }}</div>\r\n    <div class=\"font-mono text-9xl bg-slate-200 shadow-inner rounded p-2 text-center opacity-60\">{{ display[1] }}</div>\r\n    <div class=\"font-mono text-9xl bg-slate-200 shadow-inner rounded p-2 text-center opacity-60\">{{ display[2] }}</div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport gsap from 'gsap'\r\nimport { range, shuffle } from 'lodash-es'\r\n\r\nconst props = defineProps<{ target: number,digit: number }>()\r\nconst emits = defineEmits<{\r\n  (event: 'animation-start'): void,\r\n  (event: 'animation-end'): void,\r\n  (event: 'animation-update'): void\r\n}>()\r\nvar startTicks = [0, 0, 0]\r\nvar animateData: {\r\n    shuffled: number[];\r\n    ticks: number;\r\n}[]\r\nvar onComplete = () => {\r\n    emits('animation-update')\r\n  }\r\nvar onUpdate: () => void\r\nconst display = reactive(['0', '0', '0'])\r\n\r\n// first draw and first digit change\r\nwatch(() => props.target, (newTarget) => {\r\n  emits('animation-start')\r\n  // recevie new target\r\n  startTicks=[0,0,0]\r\n  const target = newTarget.toString().padStart(3, '0').split('').map(Number)\r\n  // shuffle and calculate ticks\r\n  animateData = range(0, 3).map(i => {\r\n    const shuffled = i === 0 ? shuffle(range(0, 4)) : shuffle(range(0, 10));\r\n    const targetIndex = shuffled.indexOf(target[i]);\r\n    const ticks = i === 0 ? 4 * (i + 7) + targetIndex : 10 * (i + 7) + targetIndex;\r\n    return { shuffled, ticks }\r\n    return { shuffled, ticks }\r\n  })\r\n  onComplete = () => {\r\n    emits('animation-update')\r\n  }\r\n  // first draw\r\n  onUpdate = () => {\r\n      const displayIndex = Math.round(startTicks[0]) % 4\r\n      display[0] = animateData[0].shuffled[displayIndex].toString()\r\n      display[1] = \"0\"\r\n      display[2] = \"0\"\r\n    }\r\n  // first digit change\r\n  gsap.timeline({ onUpdate, onComplete })\r\n    .to(startTicks, { '0': animateData[0].ticks, duration: 5 }, 0)\r\n  console.log(\"digit0 change\")\r\n})\r\n// second and third digit change\r\nwatch(() => props.digit, (newDigit) => {\r\n  if (newDigit == 1) {\r\n    emits('animation-start')\r\n    onComplete = () => {\r\n    emits('animation-update')\r\n    }\r\n    // third digit change\r\n    onUpdate = () => {\r\n      const displayIndex = Math.round(startTicks[1]) % 10\r\n      display[1] = animateData[1].shuffled[displayIndex].toString()\r\n    }\r\n    gsap.timeline({ onUpdate, onComplete })\r\n    .to(startTicks, { '1': animateData[1].ticks, duration: 5 }, 0)\r\n    console.log(\"digit1 change\")\r\n  } else if (newDigit == 2) {\r\n    emits('animation-start')\r\n    onComplete = () => {\r\n    emits('animation-end')\r\n    }\r\n    // third digit change\r\n    onUpdate = () => {\r\n      const displayIndex = Math.round(startTicks[2]) % 10\r\n      display[2] = animateData[2].shuffled[displayIndex].toString()\r\n    }\r\n    gsap.timeline({ onUpdate, onComplete })\r\n    .to(startTicks, { '2': animateData[2].ticks, duration: 5 }, 0)\r\n    console.log(\"digit2 change\")\r\n  }\r\n})\r\n</script>","<template>\r\n  <div>\r\n    <nav>\r\n    <ul>\r\n      <li><a href=\"/1d\">特等奖</a></li>\r\n      <li><a href=\"/1n\">大奖</a></li>\r\n      <li><a href=\"/\">幸运奖</a></li>\r\n    </ul>\r\n    </nav>\r\n  </div>\r\n  <div class=\"flex h-screen bg-center bg-no-repeat bg-cover bg-hero-pattern\">\r\n    <header class=\"absolute w-screen flex items-center justify-center pt-[10vh]\">\r\n      <img src=\"../assets/font.jpg\" class = \"scale-150 pb-40\" alt=\"兔年新春晚会抽奖\" >\r\n    </header>\r\n    <div class=\"column flex flex-col p-5\">\r\n      <img src=\"~/assets/WST.jpg\" alt=\"鸣谢WST赞助\" class=\"mt-auto flex-justify center m-5 scale-125 origin-bottom-left\" />\r\n    </div>\r\n    <main class=\"m-auto w-1/2 min-w-fit overflow-hidden rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 backdrop-blur bg-white bg-opacity-60\">\r\n      <DigitDisplaydigit\r\n        class=\"my-8\"\r\n        :target=\"dispNum\"\r\n        :digit=\"digitNum\"\r\n        @animation-start=\"loading = true\"\r\n        @animation-end=\"onAnimationEnd()\"\r\n        @animation-update=\"loading = false\"\r\n      />\r\n      <div class=\"flex justify-center my-8\">\r\n        <button\r\n          @click=\"draw()\"\r\n          :disabled=\"loading\"\r\n          :class=\"{\r\n            'bg-gray-300': loading,\r\n            'bg-red-500 hover:bg-red-600 active:bg-red-700 active:shadow-inner shadow-md': !loading,\r\n          }\"\r\n          class=\"text-white text-5xl font-medium rounded-full px-8 py-2 transition-all duration-200 disabled:cursor-wait\"\r\n        >\r\n          {{ loading ? 'Loading...' : 'Draw' }}\r\n        </button>\r\n      </div>\r\n    </main>\r\n    <div class=\"column flex flex-col p-5\">\r\n      <img src=\"~/assets/UTA.png\" alt=\"鸣谢Weeee赞助\" class=\"mt-auto flex-justify center m-5 scale-110 origin-bottom-right\"/>\r\n    </div>\r\n    <footer class=\"absolute bottom-4 w-screen text-center\">\r\n      <span class=\"text-slate-800\">&copy; <strong>UTCSSA</strong> - Alex Kuang and Junyu Yao, 2023.</span>\r\n    </footer>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n\r\nconst { $confetti } = useNuxtApp().vueApp.config.globalProperties\r\nconsole.log(useNuxtApp().vueApp)\r\nconst dispNum = ref<number>(0)\r\nconst digitNum = ref<number>(2)\r\nconst loading = ref<boolean>(false)\r\nconst lotterylist = Array.from({length: 300}, (_, i) => i + 1)\r\n\r\n\r\n\r\nconst draw = () => {\r\n  if (digitNum.value == 2) {\r\n    console.log('end')\r\n    digitNum.value = 0\r\n    dispNum.value = lotterylist[Math.floor(Math.random() * lotterylist.length)]\r\n    lotterylist.splice(lotterylist.indexOf(dispNum.value),1)\r\n    console.log(dispNum.value)\r\n  } else {\r\n    console.log('next')\r\n    digitNum.value += 1\r\n  }\r\n}\r\n\r\nconst onAnimationEnd = () => {\r\n  loading.value = false\r\n  $confetti.start({\r\n    particlesPerFrame: 2,\r\n    defaultDropRate: 15,\r\n    particles: [\r\n      { type: 'circle' },\r\n      { type: 'heart' },\r\n      { type: 'rect' },\r\n    ]\r\n  })\r\n  setTimeout(() => {\r\n    $confetti.stop()\r\n  }, 2000)\r\n}\r\n</script>\r\n\r\n<style >\r\n.column {\r\n  float: left;\r\n  width: 25%;\r\n  padding: 20px;\r\n}\r\nnav {\r\n  background-color: #333;\r\n  color: white;\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 10px 20px;\r\n}\r\nnav ul {\r\n  display: flex;\r\n  list-style: none;\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\nnav li {\r\n  margin: 0 10px;\r\n}\r\nnav a {\r\n  color: white;\r\n  text-decoration: none;\r\n}\r\n</style>"],"names":[],"mappings":"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"}